<Window x:Class="ECATPlugin.RatingPopup"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Rating Popup" Height="450" Width="800">
    <Grid Background="#004e72">
        <!-- Use the background color from your image -->
        <!-- IStructE Rating Scale -->
        <StackPanel Orientation="Vertical" HorizontalAlignment="Left" Margin="50,50,20,0">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="IStructE SCO₂RS Rating: " FontSize="18" Foreground="White" Margin="0,0,5,10"/>
                <TextBlock Text="{Binding StructeGrade}" FontSize="18" Foreground="White" Margin="0,0,0,10"/>
            </StackPanel>
            <Grid>
                <!-- Define each rating bar using colored rectangles -->
                <StackPanel>
                    <Grid Margin="0,0,0,5" HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="10" />
                            <!-- Triangle width -->
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Height="25" Width="60" Background="Green" BorderBrush="Black" BorderThickness="1,1,0,1"/>
                        <TextBlock Grid.Column="0" Text="A++" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="White" Margin="5,0,0,0"/>
                        <Polygon Grid.Column="1" Points="0,0 10,12.5 0,25" Fill="Green" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                    </Grid>

                    <Grid Margin="0,0,0,5" HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="10" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Height="25" Width="80" Background="LimeGreen" BorderBrush="Black" BorderThickness="1,1,0,1"/>
                        <TextBlock Grid.Column="0" Text="A+" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="White" Margin="5,0,0,0"/>
                        <Polygon Grid.Column="1" Points="0,0 10,12.5 0,25" Fill="LimeGreen" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                    </Grid>

                    <Grid Margin="0,0,0,5" HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="10" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Height="25" Width="100" Background="YellowGreen" BorderBrush="Black" BorderThickness="1,1,0,1"/>
                        <TextBlock Grid.Column="0" Text="A" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="Black" Margin="5,0,0,0"/>
                        <Polygon Grid.Column="1" Points="0,0 10,12.5 0,25" Fill="YellowGreen" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                    </Grid>

                    <Grid Margin="0,0,0,5" HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="10" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Height="25" Width="120" Background="Yellow" BorderBrush="Black" BorderThickness="1,1,0,1"/>
                        <TextBlock Grid.Column="0" Text="B" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="Black" Margin="5,0,0,0"/>
                        <Polygon Grid.Column="1" Points="0,0 10,12.5 0,25" Fill="Yellow" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                    </Grid>

                    <Grid Margin="0,0,0,5" HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="10" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Height="25" Width="140" Background="Orange" BorderBrush="Black" BorderThickness="1,1,0,1"/>
                        <TextBlock Grid.Column="0" Text="C" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="Black" Margin="5,0,0,0"/>
                        <Polygon Grid.Column="1" Points="0,0 10,12.5 0,25" Fill="Orange" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                    </Grid>

                    <Grid Margin="0,0,0,5" HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="10" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Height="25" Width="160" Background="DarkOrange" BorderBrush="Black" BorderThickness="1,1,0,1"/>
                        <TextBlock Grid.Column="0" Text="D" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="White" Margin="5,0,0,0"/>
                        <Polygon Grid.Column="1" Points="0,0 10,12.5 0,25" Fill="DarkOrange" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                    </Grid>

                    <Grid Margin="0,0,0,5" HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="10" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Height="25" Width="180" Background="Red" BorderBrush="Black" BorderThickness="1,1,0,1"/>
                        <TextBlock Grid.Column="0" Text="E" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="White" Margin="5,0,0,0"/>
                        <Polygon Grid.Column="1" Points="0,0 10,12.5 0,25" Fill="Red" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                    </Grid>

                    <Grid Margin="0,0,0,5" HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="10" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Height="25" Width="200" Background="DarkRed" BorderBrush="Black" BorderThickness="1,1,0,1"/>
                        <TextBlock Grid.Column="0" Text="F" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="White" Margin="5,0,0,0"/>
                        <Polygon Grid.Column="1" Points="0,0 10,12.5 0,25" Fill="DarkRed" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                    </Grid>

                    <Grid Margin="0,0,0,5" HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="10" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Height="25" Width="220" Background="DarkRed" BorderBrush="Black" BorderThickness="1,1,0,1"/>
                        <TextBlock Grid.Column="0" Text="G" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="White" Margin="5,0,0,0"/>
                        <Polygon Grid.Column="1" Points="0,0 10,12.5 0,25" Fill="DarkRed" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                    </Grid>
                </StackPanel>

                <!-- Arrow indicating the carbon rating position -->
                <Canvas>
                    <Polygon x:Name="StructeArrowPolygon" Points="0,10 20,0 20,20" Fill="Black" />

                    <!-- Label with border, positioned to the right of the arrow -->
                    <Border x:Name="StructeRatingLabelBorder" BorderBrush="Black" BorderThickness="1" Background="Black">
                        <TextBlock x:Name="StructeRatingLabel" Text="{Binding CarbonRating, StringFormat=N0}" Foreground="White" Padding="5,0" />
                    </Border>
                </Canvas>
            </Grid>
        </StackPanel>

        <!-- LETI Rating Scale -->
        <StackPanel Orientation="Vertical" HorizontalAlignment="Right" Margin="20,50,50,0">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="LETI Rating: " FontSize="18" Foreground="White" Margin="0,0,5,10"/>
                <TextBlock Text="{Binding LetiGrade}" FontSize="18" Foreground="White" Margin="0,0,0,10"/>
            </StackPanel>
            <Grid>
                <!-- Repeat the same rating bars as above -->
                <StackPanel>
                    <Grid Margin="0,0,0,5" HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="10" />
                            <!-- Triangle width -->
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Height="25" Width="60" Background="Green" BorderBrush="Black" BorderThickness="1,1,0,1"/>
                        <TextBlock Grid.Column="0" Text="A++" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="White" Margin="5,0,0,0"/>
                        <Polygon Grid.Column="1" Points="0,0 10,12.5 0,25" Fill="Green" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                    </Grid>

                    <Grid Margin="0,0,0,5" HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="10" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Height="25" Width="80" Background="LimeGreen" BorderBrush="Black" BorderThickness="1,1,0,1"/>
                        <TextBlock Grid.Column="0" Text="A+" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="White" Margin="5,0,0,0"/>
                        <Polygon Grid.Column="1" Points="0,0 10,12.5 0,25" Fill="LimeGreen" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                    </Grid>

                    <Grid Margin="0,0,0,5" HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="10" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Height="25" Width="100" Background="YellowGreen" BorderBrush="Black" BorderThickness="1,1,0,1"/>
                        <TextBlock Grid.Column="0" Text="A" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="Black" Margin="5,0,0,0"/>
                        <Polygon Grid.Column="1" Points="0,0 10,12.5 0,25" Fill="YellowGreen" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                    </Grid>

                    <Grid Margin="0,0,0,5" HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="10" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Height="25" Width="120" Background="Yellow" BorderBrush="Black" BorderThickness="1,1,0,1"/>
                        <TextBlock Grid.Column="0" Text="B" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="Black" Margin="5,0,0,0"/>
                        <Polygon Grid.Column="1" Points="0,0 10,12.5 0,25" Fill="Yellow" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                    </Grid>

                    <Grid Margin="0,0,0,5" HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="10" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Height="25" Width="140" Background="Orange" BorderBrush="Black" BorderThickness="1,1,0,1"/>
                        <TextBlock Grid.Column="0" Text="C" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="Black" Margin="5,0,0,0"/>
                        <Polygon Grid.Column="1" Points="0,0 10,12.5 0,25" Fill="Orange" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                    </Grid>

                    <Grid Margin="0,0,0,5" HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="10" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Height="25" Width="160" Background="DarkOrange" BorderBrush="Black" BorderThickness="1,1,0,1"/>
                        <TextBlock Grid.Column="0" Text="D" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="White" Margin="5,0,0,0"/>
                        <Polygon Grid.Column="1" Points="0,0 10,12.5 0,25" Fill="DarkOrange" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                    </Grid>

                    <Grid Margin="0,0,0,5" HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="10" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Height="25" Width="180" Background="Red" BorderBrush="Black" BorderThickness="1,1,0,1"/>
                        <TextBlock Grid.Column="0" Text="E" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="White" Margin="5,0,0,0"/>
                        <Polygon Grid.Column="1" Points="0,0 10,12.5 0,25" Fill="Red" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                    </Grid>

                    <Grid Margin="0,0,0,5" HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="10" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Height="25" Width="200" Background="DarkRed" BorderBrush="Black" BorderThickness="1,1,0,1"/>
                        <TextBlock Grid.Column="0" Text="F" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="White" Margin="5,0,0,0"/>
                        <Polygon Grid.Column="1" Points="0,0 10,12.5 0,25" Fill="DarkRed" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                    </Grid>

                    <Grid Margin="0,0,0,5" HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="10" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Height="25" Width="220" Background="DarkRed" BorderBrush="Black" BorderThickness="1,1,0,1"/>
                        <TextBlock Grid.Column="0" Text="G" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="White" Margin="5,0,0,0"/>
                        <Polygon Grid.Column="1" Points="0,0 10,12.5 0,25" Fill="DarkRed" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                    </Grid>
                </StackPanel>


                <!-- Arrow indicating the carbon rating position -->
                <Canvas>
                    <Polygon x:Name="LetiArrowPolygon" Points="0,10 20,0 20,20" Fill="Black" />

                    <!-- Label with border, positioned to the right of the arrow -->
                    <Border x:Name="LetiRatingLabelBorder" BorderBrush="Black" BorderThickness="1" Background="Black">
                        <TextBlock x:Name="LetiRatingLabel" Text="{Binding CarbonRating, StringFormat=N0}" Foreground="White" Padding="5,0" />
                    </Border>
                </Canvas>
            </Grid>
        </StackPanel>
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="0,10,0,10">
            <Button Content="Export Results to PNG" Click="CaptureScreenButton_Click" Margin="0,0,10,0" Padding="5,3" />
            <Button Content="Close" Click="CloseButton_Click" IsCancel="True" Padding="5,3" />
        </StackPanel>

    </Grid>

</Window>